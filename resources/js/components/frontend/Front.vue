<template>
  <div class="body">
    <!-- Start Hero Carousel -->
    <!-- SLIDER -->
    <div class="slider-wrap">
      <div class="tp-banner-container">
        <div class="tp-banner">
          <ul>
            <!-- SLIDE  -->
            <li
              data-transition="fade"
              data-slotamount="2"
              data-masterspeed="500"
              data-thumb="homeslider_thumb1.jpg"
              data-saveperformance="on"
              data-title="Intro Slide"
            >
              <!-- MAIN IMAGE -->
              <img
                src="design/images/dummy.png"
                alt="slidebg1"
                data-lazyload="design/images/slides/2.jpg"
                data-bgposition="center top"
                data-bgfit="cover"
                data-bgrepeat="no-repeat"
              />
              <!-- LAYERS -->
              <div
                class="tp-caption customin fadeout tp-resizeme rs-parallaxlevel-10"
                data-x="center"
                data-y="center"
                data-customin="x:0;y:0;z:0;rotationX:0;rotationY:0;rotationZ:0;scaleX:0;scaleY:0;skewX:0;skewY:0;opacity:0;transformPerspective:600;transformOrigin:50% 50%;"
                data-speed="800"
                data-start="1000"
                data-easing="Power3.easeInOut"
                data-splitin="none"
                data-splitout="none"
                data-elementdelay="0.1"
                data-endelementdelay="0.1"
                data-end="7300"
                data-endspeed="300"
                style="z-index: 2; max-width: 630px; max-height: 250px; background:#fff;width:100%;height:100%; white-space: nowrap;"
              ></div>
              <!-- LAYER NR. 2 -->
              <div
                class="tp-caption lft skewtoleftshort rs-parallaxlevel-9"
                data-x="center"
                data-y="250"
                data-speed="1000"
                data-start="1400"
                data-easing="Power3.easeInOut"
                data-elementdelay="0.1"
                data-endelementdelay="0.1"
                data-end="7300"
                data-endspeed="1000"
                style="z-index: 3; max-width: auto; max-height: auto; white-space: nowrap;font-family: Raleway;
                                     font-size: 36px;
                                     font-weight: bold;
                                     text-transform: uppercase;	color: #343434;"
              >
                Amazing
                <span class="ss-color" style="color:#d6644a;">Outlet</span>
              </div>
              <div
                class="tp-caption lft skewtoleftshort rs-parallaxlevel-9"
                data-x="center"
                data-y="310"
                data-speed="1000"
                data-start="1800"
                data-easing="Power3.easeInOut"
                data-elementdelay="0.1"
                data-endelementdelay="0.1"
                data-end="7300"
                data-endspeed="1000"
                style="z-index: 3; max-width: auto; max-height: auto; white-space: nowrap;	font-family: Raleway;
                                     font-size: 18px;
                                     color: #333;text-align:center;"
              >
                Clean & Elegant design with a modern style. This template includes
                <br />all you need for a fashion & accessories store
              </div>
              <div
                class="tp-caption lft skewtoleftshort rs-parallaxlevel-9"
                data-x="center"
                data-y="375"
                data-speed="1000"
                data-start="2200"
                data-easing="Power3.easeInOut"
                data-elementdelay="0.1"
                data-endelementdelay="0.1"
                data-end="7300"
                data-endspeed="1000"
                style="z-index: 3; max-width: 80px; max-height: 4px; width:100%;height:100%;background:#000000;"
              ></div>
              <a
                href="./categories-grid.html"
                class="tp-caption lft skewtoleftshort rs-parallaxlevel-9"
                data-x="center"
                data-y="395"
                data-speed="1000"
                data-start="2600"
                data-easing="Power3.easeInOut"
                data-elementdelay="0.1"
                data-endelementdelay="0.1"
                data-end="7300"
                data-endspeed="1000"
                style="z-index: 3; max-height:100%;line-height:43px;color:#fff;font-family: Montserrat;
                                   font-size: 12px;
                                   display:table;
                                   font-weight: bold;
                                   text-transform:uppercase;padding:0 40px;background:#000000;position:relative;z-index:77;"
              >Shop Now !</a>
            </li>
            <li
              data-transition="fade"
              data-slotamount="2"
              data-masterspeed="500"
              data-thumb="homeslider_thumb1.jpg"
              data-saveperformance="on"
              data-title="Intro Slide"
            >
              <!-- MAIN IMAGE -->
              <img
                src="design/images/dummy.png"
                alt="slidebg1"
                data-lazyload="design/images/slides/1.jpg"
                data-bgposition="center top"
                data-bgfit="cover"
                data-bgrepeat="no-repeat"
              />
              <!-- LAYERS -->
              <div
                class="tp-caption customin fadeout tp-resizeme rs-parallaxlevel-10"
                data-x="center"
                data-y="center"
                data-customin="x:0;y:0;z:0;rotationX:0;rotationY:0;rotationZ:0;scaleX:0;scaleY:0;skewX:0;skewY:0;opacity:0;transformPerspective:600;transformOrigin:50% 50%;"
                data-speed="800"
                data-start="1000"
                data-easing="Power3.easeInOut"
                data-splitin="none"
                data-splitout="none"
                data-elementdelay="0.1"
                data-endelementdelay="0.1"
                data-end="7300"
                data-endspeed="300"
                style="z-index: 2; max-width: 630px; max-height: 250px; background:#fff;width:100%;height:100%; white-space: nowrap;"
              ></div>
              <!-- LAYER NR. 2 -->
              <div
                class="tp-caption lft skewtoleftshort rs-parallaxlevel-9"
                data-x="center"
                data-y="250"
                data-speed="1000"
                data-start="1400"
                data-easing="Power3.easeInOut"
                data-elementdelay="0.1"
                data-endelementdelay="0.1"
                data-end="7300"
                data-endspeed="1000"
                style="z-index: 3; max-width: auto; max-height: auto; white-space: nowrap;font-family: Raleway;
                                     font-size: 36px;
                                     font-weight: bold;
                                     text-transform: uppercase;	color: #343434;"
              >
                Women
                <span class="ss-color" style="color:#d6644a;">Clothing</span>
              </div>
              <div
                class="tp-caption lft skewtoleftshort rs-parallaxlevel-9"
                data-x="center"
                data-y="310"
                data-speed="1000"
                data-start="1800"
                data-easing="Power3.easeInOut"
                data-elementdelay="0.1"
                data-endelementdelay="0.1"
                data-end="7300"
                data-endspeed="1000"
                style="z-index: 3; max-width: auto; max-height: auto; white-space: nowrap;	font-family: Raleway;
                                     font-size: 18px;
                                     color: #333;text-align:center;"
              >
                Clean & Elegant design with a modern style. This template includes
                <br />all you need for a fashion & accessories store
              </div>
              <div
                class="tp-caption lft skewtoleftshort rs-parallaxlevel-9"
                data-x="center"
                data-y="375"
                data-speed="1000"
                data-start="2200"
                data-easing="Power3.easeInOut"
                data-elementdelay="0.1"
                data-endelementdelay="0.1"
                data-end="7300"
                data-endspeed="1000"
                style="z-index: 3; max-width: 80px; max-height: 4px; width:100%;height:100%;background:#000000;"
              ></div>
              <a
                href="./categories-grid.html"
                class="tp-caption lft skewtoleftshort rs-parallaxlevel-9"
                data-x="center"
                data-y="395"
                data-speed="1000"
                data-start="2600"
                data-easing="Power3.easeInOut"
                data-elementdelay="0.1"
                data-endelementdelay="0.1"
                data-end="7300"
                data-endspeed="1000"
                style="z-index: 3; max-height:100%;line-height:43px;color:#fff;font-family: Montserrat;
                                   font-size: 12px;
                                   display:table;
                                   font-weight: bold;
                                   text-transform:uppercase;padding:0 40px;background:#000000;position:relative;z-index:77;"
              >Shop Now !</a>
            </li>
          </ul>
          <div class="tp-bannertimer"></div>
        </div>
      </div>
    </div>
    <!-- End Hero Carousel -->
    <div class="clearfix"></div>
    <!-- FEATURED PRODUCTS -->
    <div class="featured-products">
      <div class="container">
        <div class="row">
          <h5 class="heading space40">
            <span>Latest Products</span>
          </h5>
          <div class="row">
            <div class="col-md-4 col-sm-6" v-for="item in allItem" :key="item.id">
              <div class="product-item">
                <div class="item-thumb">
                  <span class="badge new">New</span>
                  <img :src="item.image_thumb" class="img-responsive" alt />
                  <div @click="showDetails(item)">
                    <i class="overlay-rmore fa fa-search quickview"></i>
                  </div>
                  <div class="product-overlay">
                    <a href="#" class="addcart fa fa-shopping-cart"></a>
                    <a href="#" class="compare fa fa-signal"></a>
                    <a href="#" class="likeitem fa fa-heart-o"></a>
                  </div>
                </div>
                <div class="product-info">
                  <h4 class="product-title">
                    <a href="#">{{ item.name }}</a>
                  </h4>
                  <span class="product-price">
                    {{ item.price | currency }}
                    <em v-if="item.status == 'Y'">- Sale</em>
                    <em v-else>- On Sold</em>
                  </span>
                  <!-- <div class="item-colors">
                    <a href="#" class="litebrown"></a>
                    <a href="#" class="white"></a>
                    <a href="#" class="red"></a>
                  </div>-->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
            <i class="fa fa-times"></i>
          </button>
          <div class="row">
            <div class="col-md-5 col-sm-6">
              <!-- <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                  <div class="carousel-item active" v-for="item in object.media.length" :key="item">
                    <img class="d-block w-100" :src="object.media[item].path" alt="First slide" />
                  </div>
                </div>
                <a
                  class="carousel-control-prev"
                  href="#carouselExampleControls"
                  role="button"
                  data-slide="prev"
                >
                  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                  <span class="sr-only">Previous</span>
                </a>
                <a
                  class="carousel-control-next"
                  href="#carouselExampleControls"
                  role="button"
                  data-slide="next"
                >
                  <span class="carousel-control-next-icon" aria-hidden="true"></span>
                  <span class="sr-only">Next</span>
                </a>
              </div>-->
              <div v-html="html">
                {{ html }}
                <!-- <carousel :data="slide"></carousel> -->
              </div>
            </div>
            <div class="col-md-7 col-sm-6">
              <div class="product-single">
                <div class="ps-header">
                  <!-- <span class="badge offer">-50%</span> -->
                  <h3>{{ object.name }}</h3>
                  <div class="ps-price">
                    <!-- <span>$ 200.00</span>  -->
                    {{ object.price | currency }}
                  </div>
                </div>

                <div class="ps-stock">
                  Stock:
                  {{ object.stock }}
                </div>
                <div class="sep"></div>
                <div class="space10"></div>
                <div class="row select-wraps">
                  <div class="col-md-5 col-sm-5">
                    <p>
                      Quantity
                      <span>*</span>
                    </p>
                    <input type="number" v-model="qty" placeholder="qty" @change="qualityHandler" />
                  </div>
                </div>
                <div class="space20"></div>
                <div class="space20"></div>
                <div class="space20"></div>
                <div class="share">
                  <!-- <span>
                    <a href="#" class="fa fa-heart-o" onclick="return false;"></a>
                    <a href="#" class="fa fa-signal" onclick="return false;"></a>
                    <a href="#" class="fa fa-envelope-o" onclick="return false;"></a>
                  </span>-->
                  <div class="addthis_native_toolbox"></div>
                </div>
                <div class="space20"></div>
                <div class="sep"></div>
                <a
                  class="btn-color"
                  v-on:click="addCart({id: object.id, qty: qty})"
                  href="#"
                >Add to Bag</a>
                <button @click="details()" class="btn-black">Go to Details</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>
<script>
import { mapGetters, mapActions } from "vuex";
export default {
  data() {
    return {
      qty: 1,
      html: "null",
      object: {},
      slide: []
    };
  },
  mounted() {},
  computed: {
    ...mapGetters(["allItem"])
  },
  created() {
    this.fetchProductLimit();
    Fire.$on("modalHide", data => {
      $("#myModal").modal("hide");
      $(".modal-backdrop").remove();
    });
  },
  methods: {
    ...mapActions(["fetchProductLimit"]),
    ...mapActions("cart", {
      addCart: "addCart"
    }),
    submitCart(id) {
      this.addCart(id, this.qty);
    },
    showDetails(item) {
      this.qty = 1;
      this.object = item;
      this.html = "";

      var photo = [];
      var html = "";
      for (let i = 0; i < this.object.media.length; i++) {
        photo[i] =
          '<img class="img-fluid" alt="Responsive image" src="' +
          this.object.media[i].path +
          '" />';

        var active = "";
        if (i == 0) {
          active = "active";
        }

        html +=
          '<div class="carousel-item ' +
          active +
          '"><img class="d-block w-100" src="' +
          this.object.media[i].path +
          '" alt="First slide"></div>';
      }
      this.html =
        '<div id="carouselExampleControls" class="carousel slide" data-ride="carousel"><div class="carousel-inner">' +
        html +
        '</div><a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev"><span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="sr-only">Previous</span></a><a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next"><span class="carousel-control-next-icon" aria-hidden="true"></span><span class="sr-only">Next</span></a></div>';
      this.slide = photo;
      console.log(this.slide);

      $("#myModal").modal("show");
    },
    details() {
      $("#myModal").modal("hide");
      $(".modal-backdrop").remove();

      this.$router.push("/detail/" + this.object.id);
    },
    qualityHandler() {
      if (this.qty == 0) {
        this.qty = 1;
      }
    }
  }
};
</script>
